<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="A3Nest.Presentation.Pages.SettingsPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:A3Nest.Presentation.ViewModels"
             x:DataType="viewmodels:SettingsViewModel"
             x:Name="SettingsPageView"
             Title="{Binding Title}">

    <ScrollView>
        <StackLayout Padding="20" Spacing="20">
            
            <!-- Header -->
            <StackLayout Spacing="8">
                <Label Text="Settings"
                       FontSize="28"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                <Label Text="Configure your application preferences"
                       FontSize="16"
                       TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray400}}" />
            </StackLayout>

            <!-- Theme Settings -->
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 8"
                    Padding="16">
                <StackLayout Spacing="16">
                    <Label Text="Appearance"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="16">
                        <StackLayout Grid.Column="0" Spacing="8">
                            <Label Text="Theme" FontSize="14" />
                            <Picker ItemsSource="{Binding ThemeOptions}"
                                    SelectedItem="{Binding SelectedTheme, Mode=TwoWay}" />
                        </StackLayout>
                        
                        <StackLayout Grid.Column="1" Spacing="8">
                            <Label Text="Language" FontSize="14" />
                            <Picker ItemsSource="{Binding LanguageOptions}"
                                    SelectedItem="{Binding SelectedLanguage, Mode=TwoWay}" />
                        </StackLayout>
                    </Grid>
                </StackLayout>
            </Border>

            <!-- Notification Settings -->
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 8"
                    Padding="16">
                <StackLayout Spacing="16">
                    <Label Text="Notifications"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                    
                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto,Auto,Auto" RowSpacing="12">
                        
                        <Label Grid.Row="0" Grid.Column="0" Text="Enable Notifications" VerticalOptions="Center" />
                        <CheckBox Grid.Row="0" Grid.Column="1" IsChecked="{Binding EnableNotifications, Mode=TwoWay}" />
                        
                        <Label Grid.Row="1" Grid.Column="0" Text="Email Notifications" VerticalOptions="Center" />
                        <CheckBox Grid.Row="1" Grid.Column="1" IsChecked="{Binding EnableEmailNotifications, Mode=TwoWay}" />
                        
                        <Label Grid.Row="2" Grid.Column="0" Text="Push Notifications" VerticalOptions="Center" />
                        <CheckBox Grid.Row="2" Grid.Column="1" IsChecked="{Binding EnablePushNotifications, Mode=TwoWay}" />
                        
                        <Label Grid.Row="3" Grid.Column="0" Text="Sound Notifications" VerticalOptions="Center" />
                        <CheckBox Grid.Row="3" Grid.Column="1" IsChecked="{Binding EnableSoundNotifications, Mode=TwoWay}" />
                        
                        <Label Grid.Row="4" Grid.Column="0" Text="Notification Frequency" VerticalOptions="Center" />
                        <Picker Grid.Row="4" Grid.Column="1" 
                                ItemsSource="{Binding NotificationFrequencyOptions}"
                                SelectedItem="{Binding NotificationFrequency, Mode=TwoWay}"
                                WidthRequest="150" />
                    </Grid>
                </StackLayout>
            </Border>

            <!-- General Settings -->
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 8"
                    Padding="16">
                <StackLayout Spacing="16">
                    <Label Text="General"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="16" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="12">
                        
                        <StackLayout Grid.Row="0" Grid.Column="0" Spacing="4">
                            <Label Text="Date Format" FontSize="14" />
                            <Picker ItemsSource="{Binding DateFormatOptions}"
                                    SelectedItem="{Binding DateFormat, Mode=TwoWay}" />
                        </StackLayout>
                        
                        <StackLayout Grid.Row="0" Grid.Column="1" Spacing="4">
                            <Label Text="Time Format" FontSize="14" />
                            <Picker ItemsSource="{Binding TimeFormatOptions}"
                                    SelectedItem="{Binding TimeFormat, Mode=TwoWay}" />
                        </StackLayout>
                        
                        <StackLayout Grid.Row="1" Grid.Column="0" Spacing="4">
                            <Label Text="Currency" FontSize="14" />
                            <Picker ItemsSource="{Binding CurrencyOptions}"
                                    SelectedItem="{Binding Currency, Mode=TwoWay}" />
                        </StackLayout>
                        
                        <StackLayout Grid.Row="1" Grid.Column="1" Spacing="4">
                            <Label Text="Auto Save Interval (minutes)" FontSize="14" />
                            <Entry Text="{Binding AutoSaveInterval, Mode=TwoWay}"
                                   Keyboard="Numeric" />
                        </StackLayout>
                        
                        <Grid Grid.Row="2" Grid.ColumnSpan="2" ColumnDefinitions="*,Auto">
                            <Label Grid.Column="0" Text="Enable Auto Save" VerticalOptions="Center" />
                            <CheckBox Grid.Column="1" IsChecked="{Binding AutoSaveEnabled, Mode=TwoWay}" />
                        </Grid>
                    </Grid>
                </StackLayout>
            </Border>

            <!-- Data & Sync Settings -->
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 8"
                    Padding="16">
                <StackLayout Spacing="16">
                    <Label Text="Data &amp; Sync"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                    
                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="12">
                        
                        <Label Grid.Row="0" Grid.Column="0" Text="Enable Data Sync" VerticalOptions="Center" />
                        <CheckBox Grid.Row="0" Grid.Column="1" IsChecked="{Binding EnableDataSync, Mode=TwoWay}" />
                        
                        <Label Grid.Row="1" Grid.Column="0" Text="Sync Frequency" VerticalOptions="Center" />
                        <Picker Grid.Row="1" Grid.Column="1" 
                                ItemsSource="{Binding SyncFrequencyOptions}"
                                SelectedItem="{Binding SyncFrequency, Mode=TwoWay}"
                                WidthRequest="150" />
                        
                        <Label Grid.Row="2" Grid.Column="0" Text="Enable Offline Mode" VerticalOptions="Center" />
                        <CheckBox Grid.Row="2" Grid.Column="1" IsChecked="{Binding EnableOfflineMode, Mode=TwoWay}" />
                        
                        <Label Grid.Row="3" Grid.Column="0" Text="Cache Size" VerticalOptions="Center" />
                        <Picker Grid.Row="3" Grid.Column="1" 
                                ItemsSource="{Binding CacheSizeOptions}"
                                SelectedItem="{Binding CacheSize, Mode=TwoWay}"
                                WidthRequest="150" />
                    </Grid>
                </StackLayout>
            </Border>

            <!-- Privacy Settings -->
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 8"
                    Padding="16">
                <StackLayout Spacing="16">
                    <Label Text="Privacy"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                    
                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto" RowSpacing="12">
                        
                        <Label Grid.Row="0" Grid.Column="0" Text="Enable Analytics" VerticalOptions="Center" />
                        <CheckBox Grid.Row="0" Grid.Column="1" IsChecked="{Binding EnableAnalytics, Mode=TwoWay}" />
                        
                        <Label Grid.Row="1" Grid.Column="0" Text="Enable Crash Reporting" VerticalOptions="Center" />
                        <CheckBox Grid.Row="1" Grid.Column="1" IsChecked="{Binding EnableCrashReporting, Mode=TwoWay}" />
                    </Grid>
                </StackLayout>
            </Border>

            <!-- Action Buttons -->
            <Grid ColumnDefinitions="*,*,*" ColumnSpacing="12">
                <Button Grid.Column="0"
                        Text="Save Settings"
                        Command="{Binding SaveSettingsCommand}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                        TextColor="White"
                        IsEnabled="{Binding HasUnsavedChanges}" />
                
                <Button Grid.Column="1"
                        Text="Reset to Defaults"
                        Command="{Binding ResetToDefaultsCommand}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource Secondary}, Dark={StaticResource SecondaryDark}}"
                        TextColor="White" />
                
                <Button Grid.Column="2"
                        Text="Clear Cache"
                        Command="{Binding ClearCacheCommand}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource Tertiary}, Dark={StaticResource TertiaryDark}}"
                        TextColor="White" />
            </Grid>

            <!-- App Information -->
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 8"
                    Padding="16">
                <StackLayout Spacing="12">
                    <Label Text="App Information"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="16">
                        <StackLayout Grid.Column="0" Spacing="4">
                            <Label Text="Version" FontSize="14" FontAttributes="Bold" />
                            <Label Text="{Binding AppVersion}" FontSize="14" />
                        </StackLayout>
                        
                        <StackLayout Grid.Column="1" Spacing="4">
                            <Label Text="Build" FontSize="14" FontAttributes="Bold" />
                            <Label Text="{Binding BuildNumber}" FontSize="14" />
                        </StackLayout>
                    </Grid>
                    
                    <Grid ColumnDefinitions="*,*,*" ColumnSpacing="8">
                        <Button Grid.Column="0"
                                Text="About"
                                Command="{Binding ViewAboutCommand}"
                                BackgroundColor="Transparent"
                                TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                                FontSize="12" />
                        
                        <Button Grid.Column="1"
                                Text="Privacy Policy"
                                Command="{Binding ViewPrivacyPolicyCommand}"
                                BackgroundColor="Transparent"
                                TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                                FontSize="12" />
                        
                        <Button Grid.Column="2"
                                Text="Support"
                                Command="{Binding ContactSupportCommand}"
                                BackgroundColor="Transparent"
                                TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                                FontSize="12" />
                    </Grid>
                </StackLayout>
            </Border>
        </StackLayout>
    </ScrollView>

    <!-- Loading Overlay -->
    <Grid IsVisible="{Binding IsLoading}"
          BackgroundColor="Black"
          Opacity="0.5">
        <ActivityIndicator IsRunning="{Binding IsLoading}"
                           Color="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                           VerticalOptions="Center"
                           HorizontalOptions="Center" />
    </Grid>
</ContentPage>