<?xml version="1.0" encoding="utf-8" ?>
<ContentView x:Class="A3Nest.Presentation.Components.SearchBar"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml">
    <Border BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundSecondary}, Dark={StaticResource Surface}}"
            Stroke="{AppThemeBinding Light={StaticResource BorderPrimary}, Dark={StaticResource BorderPrimary}}"
            StrokeThickness="1"
            StrokeShape="RoundRectangle 8"
            Padding="16">
        <Grid ColumnDefinitions="Auto,*,Auto,Auto">
            <!-- Search Icon -->
            <Image Grid.Column="0"
                   Source="search_icon.svg"
                   WidthRequest="20"
                   HeightRequest="20"
                   VerticalOptions="Center"
                   Margin="0,0,8,0"
                   Opacity="0.6" />

            <!-- Search Entry -->
            <Entry x:Name="SearchEntry"
                   Grid.Column="1"
                   Text="{Binding Source={x:Reference SearchBarView}, Path=SearchText, Mode=TwoWay}"
                   Placeholder="{Binding Source={x:Reference SearchBarView}, Path=Placeholder}"
                   BackgroundColor="Transparent"
                   TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark={StaticResource TextPrimary}}"
                   PlaceholderColor="{AppThemeBinding Light={StaticResource TextTertiary}, Dark={StaticResource TextTertiary}}"
                   VerticalOptions="Center"
                   FontSize="14"
                   FontFamily="OpenSansRegular"
                   ReturnType="Search"
                   ReturnCommand="{Binding Source={x:Reference SearchBarView}, Path=SearchCommand}"
                   ReturnCommandParameter="{Binding Source={x:Reference SearchBarView}, Path=SearchText}"
                   TextChanged="OnSearchTextChanged" />

            <!-- Clear Button -->
            <Button x:Name="ClearButton"
                    Grid.Column="2"
                    Text="âœ•"
                    BackgroundColor="Transparent"
                    TextColor="{AppThemeBinding Light={StaticResource TextTertiary}, Dark={StaticResource TextTertiary}}"
                    FontSize="16"
                    WidthRequest="32"
                    HeightRequest="32"
                    Padding="0"
                    Margin="4,0"
                    Command="{Binding Source={x:Reference SearchBarView}, Path=ClearCommand}"
                    IsVisible="{Binding Source={x:Reference SearchBarView}, Path=HasSearchText}" />

            <!-- Search Button -->
            <Button x:Name="SearchButton"
                    Grid.Column="3"
                    Text="Search"
                    Style="{StaticResource PrimaryButtonStyle}"
                    FontSize="12"
                    Padding="16,8"
                    Command="{Binding Source={x:Reference SearchBarView}, Path=SearchCommand}"
                    CommandParameter="{Binding Source={x:Reference SearchBarView}, Path=SearchText}"
                    IsVisible="{Binding Source={x:Reference SearchBarView}, Path=ShowSearchButton}" />
        </Grid>
    </Border>
</ContentView>