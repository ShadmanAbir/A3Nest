<?xml version="1.0" encoding="utf-8" ?>
<ContentView x:Class="A3Nest.Presentation.Components.CardWidget"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml">
    <Border x:Name="CardContainer" Style="{StaticResource InteractiveCardStyle}">
        
        <Grid RowDefinitions="Auto,*,Auto" RowSpacing="12">
            <!-- Header Section -->
            <Grid Grid.Row="0" 
                  ColumnDefinitions="*,Auto"
                  ColumnSpacing="12">
                <Label x:Name="TitleLabel"
                       Text="{Binding Source={x:Reference CardWidgetView}, Path=Title}"
                       Style="{StaticResource HeadingSmall}"
                       VerticalOptions="Center"
                       LineBreakMode="TailTruncation" />
                
                <Border Grid.Column="1"
                        BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundSecondary}, Dark={StaticResource SurfaceVariant}}"
                        StrokeShape="RoundRectangle 6"
                        Padding="6"
                        IsVisible="{Binding Source={x:Reference CardWidgetView}, Path=HasIcon}">
                    <Image x:Name="IconImage"
                           Source="{Binding Source={x:Reference CardWidgetView}, Path=IconSource}"
                           WidthRequest="20"
                           HeightRequest="20"
                           VerticalOptions="Center"
                           HorizontalOptions="Center" />
                </Border>
            </Grid>

            <!-- Content Section -->
            <StackLayout Grid.Row="1" 
                         x:Name="ContentContainer"
                         Spacing="8">
                <!-- Primary Value Display -->
                <Label x:Name="PrimaryValueLabel"
                       Text="{Binding Source={x:Reference CardWidgetView}, Path=PrimaryValue}"
                       FontSize="28"
                       FontFamily="OpenSansBold"
                       HorizontalOptions="Start"
                       TextColor="{Binding Source={x:Reference CardWidgetView}, Path=PrimaryValueColor}"
                       IsVisible="{Binding Source={x:Reference CardWidgetView}, Path=HasPrimaryValue}"
                       LineBreakMode="TailTruncation" />

                <!-- Secondary Value Display -->
                <Label x:Name="SecondaryValueLabel"
                       Text="{Binding Source={x:Reference CardWidgetView}, Path=SecondaryValue}"
                       Style="{StaticResource BodyMedium}"
                       IsVisible="{Binding Source={x:Reference CardWidgetView}, Path=HasSecondaryValue}"
                       LineBreakMode="WordWrap" />

                <!-- Custom Content Area -->
                <ContentPresenter x:Name="CustomContentPresenter"
                                  Content="{Binding Source={x:Reference CardWidgetView}, Path=CustomContent}" />
            </StackLayout>

            <!-- Footer Section -->
            <Grid Grid.Row="2" 
                  ColumnDefinitions="*,Auto"
                  ColumnSpacing="12"
                  IsVisible="{Binding Source={x:Reference CardWidgetView}, Path=HasFooter}">
                <Label x:Name="FooterTextLabel"
                       Text="{Binding Source={x:Reference CardWidgetView}, Path=FooterText}"
                       Style="{StaticResource Caption}"
                       VerticalOptions="Center"
                       LineBreakMode="TailTruncation" />
                
                <Button x:Name="ActionButton"
                        Grid.Column="1"
                        Text="{Binding Source={x:Reference CardWidgetView}, Path=ActionButtonText}"
                        Command="{Binding Source={x:Reference CardWidgetView}, Path=ActionCommand}"
                        Style="{StaticResource TertiaryButtonStyle}"
                        FontSize="12"
                        Padding="12,6"
                        MinimumHeightRequest="32"
                        IsVisible="{Binding Source={x:Reference CardWidgetView}, Path=HasActionButton}" />
            </Grid>
        </Grid>
    </Border>
</ContentView>